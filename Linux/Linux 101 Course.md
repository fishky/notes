#引导系统
>注：以下内容针对的是使用BIOS引导的x86和x86_64架构。

* **PCs 的引导过程：**
 1.  当 PC 启动时，BIOS (Basic Input Output Service) 会执行一个自检。
 -  当机器通过自检时，BIOS 会加载 Master Boot Record（或 MBR，通常位于引导驱动器的第一个 512 字节扇区）。引动驱动器通常是系统上的第一个硬盘驱动器，但也可以是一个磁盘、CD 或 USB 密匙。
 - 对于硬盘驱动器，MBR 加载一个阶段 1 启动加载程序，该程序通常是 Linux 系统上的 LILO 或 GRUB 阶段 1 启动加载程序。这是另一个 512 字节单扇区记录。
  - 阶段 1 启动加载程序通常加载一个记录序列，该序列通常称为阶段 2 启动加载程序（有时称为阶段 1.5 加载程序）。
  - 阶段 2 加载程序加载操作系统。对于 Linux，这是内核，也可能是初始 RAM 磁盘 (initrd)。 
* 当使用多个操作系统时，可能需要使用一些**特殊代码**来引导，这类程序包括：    
 - **Loadlin**    
一个 DOS 可执行程序，可以在一个正在运行的 DOS 系统中调用以引导一个 Linux 分区。如果多引导系统的设置过程很复杂、风险很大时，这个代码就很有用。    
 - **OS/2 Boot Manager**    
这个程序安装在一个专用小分区上，分区被标记为 active，标准 MBR 引导进程启动 OS/2 Boot Manager，之后会显示一个菜单用于选择要引导的操作系统。    
 - **智能启动加载程序**  
该程序可以驻留在操作系统的分区上，并可以通过一个活动分区的分区引导记录调用，也可以通过主引导记录调用。此类程序包括：
     -  BootMagic（Norton PartitionMagic 的一个组件）
     -  LILO (LInux LOader)
     - GRUB (GRand Unified Boot loader)（现在称为 GRUB Legacy）
     - GRUB2
* **链式加载**   
>当一个引导管理器获得控制权时，它能做的一件事就是加载另一个引导管理器。这种现象称为链式加载 (chain loading)，通常发生在位于主引导记录 (MBR) 中的引导管理器加载一个分区引导记录中的启动加载程序的时候。当一个 Linux 启动加载程序被请求引导一个 Windows 或 DOS 分区时，或者当一个系统的 Linux 启动加载程序被请求加载另一个系统的启动加载程序时，几乎总是需要进行链式加载。

* LILO 配置文件默认为 `/etc/lilo.conf`。每当更改 `/etc/lilo.conf` 或者安装新内核时，都必须运行 lilo。lilo 程序会重写 MBR 或分区引导记录以反映您的更改，包括记录内核的绝对磁盘路径。

* GRUB 配置文件默认为 `/boot/grub/grub.conf` 或 `/boot/grub/menu.lst`。如果二者同时存在，那么一个通常是另一个的符号链接。

* **GRUB shell**与**LILO**不同，GRUB 的表现形式是一个小 shell。它包含几个命令，允许执行类似操作：在命令执行之前编辑命令、查找并加载配置文件、或者使用 `cat` 命令显示文件。在菜单中的条目上按 `e` 键将编辑条目，按 `c` 键切换到 GRUB 命令行，按 `b` 键引导系统，按 `p` 键输入密码，按 `Esc` 键返回菜单或上一步。还有一个 grub 命令，用于创建一个模拟 shell，可以在其中测试 GRUB 配置或您的 GRUB 命令技能。普通用户模式提供一些基本组件，但许多命令都需要根权限。清单 7 展示如何作为根用户启动 `grub shell`。这个 `grub` 命令通常位于 `/sbin` 或 `/usr/sbin` 中。

* **内核参数**
内核参数（有时称为启动参数）为内核提供其可能无法独自确定的硬件参数信息，其目的是覆盖内核以其他方式可能检测到的值，或者避免检测到不适当的值。

* **init 进程**
内核加载完成后，通常会启动 `/sbin/init`。这个程序在系统关闭之前将一直运行。它总是被分配进程 `ID 1`
`init` 程序通过运行一系列脚本引导系统的其余部分。这些脚本通常位于 `/etc/rc.d/init.d` 或 `/etc/init.d` 中，它们执行一些服务，比如设置系统的主机名、检查文件系统错误、装载其他文件系统、启用网络、启动打印服务，等等。这些脚本执行完后，`init` 启动一个名为 `getty` 的程序，在控制台上显示登录提示。图形登录屏幕通过一个图形显示管理器处理，比如 `GDM for Gnome`。

* 内核没有进程标识符，因此系统会将内核（或模块）输出消息保存到内核环缓冲区 中。可以使用 `dmesg` 命令显示内核环缓冲区，会在标准输出上显示这些消息。

* `/var/log/messages`
当系统启动到运行 `/sbin/init` 的时点后，如您所见，内核仍然在内核环缓冲区中记录事件，但进程使用 `syslog` 守护进程来记录消息，日志文件通常位于 `/var/log/messages` 中。与内核环缓冲区不同，每个 `syslog` 行都有一个时间戳，日志文件在系统能够重启之间持久化。如果引导进程中的 `init` 脚本阶段出现错误，那么您应该首先检查这个文件。
